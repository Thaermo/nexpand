Q1: SOLIOTION

SELECT
  MP.MEDICATION_PRESCRIBED,
  M.MEDICATION,
  CASE
    WHEN M.Expiration_Date < CURRENT_DATE THEN 'Expired'
    ELSE 'Active'
  END AS MedicationStatus,
  COUNT(*) AS PatientsCount
FROM
  MEDICATION_PRESCRIBED MP
JOIN
  MEDICATION M ON MP.Medication_ID = M.Medication_ID
GROUP BY
  MP.MEDICATION_PRESCRIBED, M.MEDICATION, MedicationStatus;


Q2: SOLIOTION

SELECT
  D.DOCTOR,
  DEP.DEPARTMENT,
  DP.DOCTOR_PATIENT,
  P.PATIENT,
  W.WORKER
FROM
  DOCTOR D
JOIN
  DOCTOR_PATIENT DP ON D.Doctor_ID = DP.Doctor_ID
JOIN
  DEPARTMENT DEP ON D.Department_ID = DEP.Department_ID
JOIN
  PATIENT P ON DP.Patient_ID = P.Patient_ID
JOIN
  WORKER W ON D.D_Worker_ID = W.Worker_ID
WHERE
  P.Age > 12
  AND YEAR(DP.Time) != 2022
ORDER BY
  W.Name DESC, P.Name ASC;
